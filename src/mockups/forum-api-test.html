<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Forum API test</title>
</head>

<body>

    <ol id="forum-topics"></ol>

<script>
var topicList = document.querySelector('#forum-topics');

var request = new XMLHttpRequest();
request.open('GET', 'https://forum.textpattern.io/api/?limit=10&sort=posted', true);
request.responseType = 'json';
request.onload = function (e) {
    if (request.readyState === 4) {
        if (request.status === 200) {
            var topicListing = request.response;
            showTopics(topicListing);
        } else {
            console.error(request.statusText);
        }
    }
};
request.onerror = function (e) {
    console.error(request.statusText);
};
request.send();

function showTopics(jsonObj) {
    var topics = jsonObj['topic'];

    topics.forEach(function(v,i) {
        var listItem = document.createElement('li');

        var itemTitle = document.createElement('h2');
        var itemAuthor = document.createElement('p');
        var itemPosted = document.createElement('p');
        var itemPostedUtc = document.createElement('p');
        var itemLink = document.createElement('p');

        itemTitle.textContent = topics[i].title;
        itemAuthor.textContent = 'Author: ' + topics[i].author.name;
        itemPosted.textContent = 'Posted: ' + topics[i].posted;
        itemPostedUtc.textContent = 'Posted (UTC format): ' + topics[i].postedutc;
        itemLink.textContent = 'Link: ' + topics[i].link;

        listItem.appendChild(itemTitle);
        listItem.appendChild(itemAuthor);
        listItem.appendChild(itemPosted);
        listItem.appendChild(itemPostedUtc);
        listItem.appendChild(itemLink);

        topicList.appendChild(listItem);
    });
}
</script>
</body>
</html>
